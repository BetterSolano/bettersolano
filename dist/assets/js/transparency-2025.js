const SRE_DATA={q1:{period:"Q1 2025",periodLabel:"Jan - Mar",income:{local:{taxRevenue:{realPropertyTax:{generalFund:6.21,sef:7.76,total:13.97},businessTax:49.66,otherTaxes:1.58,total:65.21},nonTaxRevenue:{regulatoryFees:10.43,serviceCharges:13.1,economicEnterprises:0,otherReceipts:.11,total:23.64},total:88.85},external:{nationalTaxAllotment:69.62,otherShares:0,interLocalTransfers:0,extraordinaryReceipts:0,total:69.62},total:158.47},expenditures:{generalPublicServices:42.76,socialServices:{education:2.42,health:7.09,labor:0,housing:0,socialWelfare:3.83,total:13.33},economicServices:11.07,debtService:.35,total:67.51},netOperatingIncome:90.96,fundBalanceEnd:283.29,fundBalanceBeginning:204.64},q2:{period:"Q2 2025",periodLabel:"Apr - Jun",income:{local:{taxRevenue:{realPropertyTax:{generalFund:7.05,sef:8.82,total:15.87},businessTax:60.47,otherTaxes:1.82,total:78.16},nonTaxRevenue:{regulatoryFees:12.65,serviceCharges:23.12,economicEnterprises:0,otherReceipts:.23,total:36},total:114.15},external:{nationalTaxAllotment:139.25,otherShares:0,interLocalTransfers:0,extraordinaryReceipts:0,total:139.25},total:253.4},expenditures:{generalPublicServices:88.31,socialServices:{education:4.82,health:16.53,labor:0,housing:0,socialWelfare:9.21,total:30.56},economicServices:20.32,debtService:1.29,total:140.48},netOperatingIncome:112.92,fundBalanceEnd:275.2,fundBalanceBeginning:204.64}};function formatPesoMillions(e){if(null==e||isNaN(e))return"₱0.00 M";const t=Number(e);return`₱${(Math.round(100*t)/100).toFixed(2)} M`}function calculatePercentage(e,t){if(!t||0===t)return 0;const a=e/t*100;return Math.round(10*a)/10}"undefined"!=typeof module&&module.exports&&(module.exports={SRE_DATA:SRE_DATA,formatPesoMillions:formatPesoMillions,calculatePercentage:calculatePercentage});let currentQuarter="q1",incomeChart=null,expenditureChart=null;function selectQuarter(e){"q1"!==e&&"q2"!==e&&(e="q1"),currentQuarter=e;const t=SRE_DATA[e];document.querySelectorAll(".quarter-tab").forEach(t=>{const a=t.dataset.quarter===e;t.classList.toggle("active",a),t.setAttribute("aria-selected",a?"true":"false")}),updateMetrics(t),updateIncomeSection(t),updateExpenditureSection(t)}function updateMetrics(e){const t=document.getElementById("metric-income"),a=document.getElementById("metric-expenditures"),n=document.getElementById("metric-net"),o=document.getElementById("metric-balance"),i=document.getElementById("metric-income-source"),r=document.getElementById("metric-expenditures-source");t&&animateValue(t,e.income.total),a&&animateValue(a,e.expenditures.total),n&&animateValue(n,e.netOperatingIncome),o&&animateValue(o,e.fundBalanceEnd),i&&(i.textContent=e.period),r&&(r.textContent=e.period)}function animateValue(e,t){e.classList.add("value-updating"),setTimeout(()=>{e.textContent=formatPesoMillions(t),e.classList.remove("value-updating")},150)}function updateIncomeSection(e){const t=e.income,a=t.total,n=document.getElementById("income-period-text");n&&(n.textContent=`Breakdown of municipal revenue for ${e.period}`),updateElement("income-local-amount",formatPesoMillions(t.local.total)),updateElement("income-local-pct",calculatePercentage(t.local.total,a)+"%"),updateElement("income-tax-revenue",formatPesoMillions(t.local.taxRevenue.total)),updateElement("income-rpt",formatPesoMillions(t.local.taxRevenue.realPropertyTax.total)),updateElement("income-business-tax",formatPesoMillions(t.local.taxRevenue.businessTax)),updateElement("income-non-tax",formatPesoMillions(t.local.nonTaxRevenue.total)),updateElement("income-external-amount",formatPesoMillions(t.external.total)),updateElement("income-external-pct",calculatePercentage(t.external.total,a)+"%"),updateElement("income-nta",formatPesoMillions(t.external.nationalTaxAllotment)),updateElement("income-other-shares",formatPesoMillions(t.external.otherShares)),incomeChart&&(incomeChart.data.datasets[0].data=[t.local.total,t.external.total],incomeChart.update("active"))}function updateExpenditureSection(e){const t=e.expenditures,a=t.total,n=calculatePercentage(t.generalPublicServices,a),o=calculatePercentage(t.socialServices.total,a),i=calculatePercentage(t.economicServices,a),r=calculatePercentage(t.debtService,a);updateElement("exp-gps-amount",formatPesoMillions(t.generalPublicServices)),updateElement("exp-gps-pct",n+"%"),updateBarWidth("exp-gps-bar",n),updateElement("exp-social-amount",formatPesoMillions(t.socialServices.total)),updateElement("exp-social-pct",o+"%"),updateBarWidth("exp-social-bar",o),updateElement("exp-health",formatPesoMillions(t.socialServices.health)),updateElement("exp-welfare",formatPesoMillions(t.socialServices.socialWelfare)),updateElement("exp-education",formatPesoMillions(t.socialServices.education)),updateElement("exp-economic-amount",formatPesoMillions(t.economicServices)),updateElement("exp-economic-pct",i+"%"),updateBarWidth("exp-economic-bar",i),updateElement("exp-debt-amount",formatPesoMillions(t.debtService)),updateElement("exp-debt-pct",r+"%"),updateBarWidth("exp-debt-bar",r),expenditureChart&&(expenditureChart.data.datasets[0].data=[t.generalPublicServices,t.socialServices.total,t.economicServices,t.debtService],expenditureChart.update("active"))}function updateElement(e,t){const a=document.getElementById(e);a&&(a.textContent=t)}function updateBarWidth(e,t){const a=document.getElementById(e);a&&(a.style.width=t+"%")}function initCharts(){const e=document.getElementById("incomeChart"),t=document.getElementById("expenditureChart");if(e&&"undefined"!=typeof Chart){const t=SRE_DATA[currentQuarter];incomeChart=new Chart(e,{type:"doughnut",data:{labels:["Local Sources","External Sources"],datasets:[{data:[t.income.local.total,t.income.external.total],backgroundColor:["#10b981","#0ea5e9"],borderWidth:0,hoverOffset:8}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"60%",plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(e){return e.label+": ₱"+e.raw.toFixed(2)+" M"}}}},animation:{animateRotate:!0,animateScale:!0,duration:800}}})}if(t&&"undefined"!=typeof Chart){const e=SRE_DATA[currentQuarter].expenditures;expenditureChart=new Chart(t,{type:"doughnut",data:{labels:["General Public Services","Social Services","Economic Services","Debt Service"],datasets:[{data:[e.generalPublicServices,e.socialServices.total,e.economicServices,e.debtService],backgroundColor:["#3b82f6","#8b5cf6","#f59e0b","#ef4444"],borderWidth:0,hoverOffset:8}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"60%",plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(e){return e.label+": ₱"+e.raw.toFixed(2)+" M"}}}},animation:{animateRotate:!0,animateScale:!0,duration:800}}})}}function initEventListeners(){document.querySelectorAll(".sre-tab").forEach(e=>{e.addEventListener("click",function(){const e=this.dataset.quarter;selectQuarter(e),document.querySelectorAll(".sre-tab").forEach(t=>{const a=t.dataset.quarter===e;t.classList.toggle("active",a),t.setAttribute("aria-selected",a?"true":"false")})})}),document.querySelectorAll(".quarter-tab").forEach(e=>{e.addEventListener("click",function(){selectQuarter(this.dataset.quarter)}),e.addEventListener("keydown",function(e){if("Enter"===e.key||" "===e.key){e.preventDefault();selectQuarter(this.dataset.quarter)}})})}function initScrollAnimations(){if("undefined"==typeof IntersectionObserver)return;const e=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const t=e.target.dataset.delay||0;setTimeout(()=>{e.target.classList.add("visible")},t)}})},{threshold:.1});document.querySelectorAll(".animate-on-scroll, .metric-card").forEach(t=>{e.observe(t)})}function initExpenditureBars(){document.querySelectorAll(".expenditure-fill[data-width]").forEach(e=>{const t=e.dataset.width;t&&(e.style.width=t+"%")})}function init(){initEventListeners(),initCharts(),initScrollAnimations(),initExpenditureBars(),selectQuarter("q1")}"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",init):init());