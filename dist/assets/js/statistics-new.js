const COLORS={primary:"#0032a0",primaryDark:"#002170",secondary:"#003D82",accent:"#F77F00",success:"#06A77D",info:"#0077BE"},barangayData=[{name:"Roxas",pop:9088},{name:"Quirino",pop:6572},{name:"Osme√±a",pop:6403},{name:"Quezon",pop:5758},{name:"Curifang",pop:4885},{name:"Bagahabag",pop:4731},{name:"Uddiawan",pop:4217},{name:"Bascaran",pop:3845},{name:"Aggub",pop:3101},{name:"San Luis",pop:2668},{name:"Communal",pop:2586},{name:"Lactawan",pop:2109},{name:"San Juan",pop:1965},{name:"Concepcion",pop:1954},{name:"Dadap",pop:1409},{name:"Wacal",pop:1398},{name:"Bangaan",pop:1284},{name:"Tucal",pop:1244},{name:"Bangar",pop:1146},{name:"Pilar D. Galima",pop:1146},{name:"Poblacion North",pop:970},{name:"Poblacion South",pop:817}],historicalData={years:[1990,1995,2e3,2007,2010,2015,2020,2024],populations:[38006,42857,47288,53004,56831,62649,65896,69296]};let charts={};function animateCount(t,a,e=2e3){const n=performance.now();requestAnimationFrame(function o(i){const r=i-n,l=Math.min(r/e,1),s=1-Math.pow(1-l,3),c=Math.floor(0+(a-0)*s);t.textContent=c.toLocaleString(),l<1?requestAnimationFrame(o):t.textContent=a.toLocaleString()})}function initScrollAnimations(){const t=new IntersectionObserver(a=>{a.forEach(a=>{if(a.isIntersecting){const e=a.target.dataset.delay||0;setTimeout(()=>{a.target.classList.add("visible");const t=a.target.querySelector("[data-count]");if(t){animateCount(t,parseInt(t.dataset.count))}animateBars(a.target)},e),t.unobserve(a.target)}})},{threshold:.2});document.querySelectorAll(".animate-on-scroll, .metric-card").forEach(a=>{t.observe(a)})}function animateBars(t){t.querySelectorAll(".breakdown-segment").forEach(t=>{const a=t.dataset.width;a&&setTimeout(()=>{t.style.width=a+"%"},300)}),t.querySelectorAll(".bar-wrap .bar").forEach(t=>{const a=t.dataset.width;a&&setTimeout(()=>{t.style.width=a+"%"},100)}),t.querySelectorAll(".sector-bar").forEach(t=>{const a=t.dataset.width;a&&setTimeout(()=>{t.style.width=a+"%"},200)}),t.querySelectorAll(".poverty-fill").forEach(t=>{const a=t.dataset.width;a&&setTimeout(()=>{t.style.width=10*a+"%"},300)})}function createHistoricalChart(){const t=document.getElementById("historicalLineChart");if(!t)return;const a=t.getContext("2d").createLinearGradient(0,0,0,400);a.addColorStop(0,"rgba(0, 50, 160, 0.2)"),a.addColorStop(1,"rgba(0, 50, 160, 0)"),charts.historical=new Chart(t,{type:"line",data:{labels:historicalData.years,datasets:[{label:"Population",data:historicalData.populations,borderColor:COLORS.primary,backgroundColor:a,fill:!0,tension:.4,pointBackgroundColor:COLORS.primary,pointBorderColor:"#fff",pointBorderWidth:3,pointRadius:6,pointHoverRadius:8,pointHoverBorderWidth:3}]},options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:2e3,easing:"easeOutQuart"},interaction:{intersect:!1,mode:"index"},plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(0, 50, 160, 0.95)",titleFont:{size:14,weight:"600"},bodyFont:{size:13},padding:12,cornerRadius:8,displayColors:!1,callbacks:{label:t=>`Population: ${t.raw.toLocaleString()}`}}},scales:{x:{grid:{display:!1},ticks:{font:{size:12}}},y:{beginAtZero:!1,grid:{color:"rgba(0,0,0,0.05)"},ticks:{font:{size:12},callback:t=>t/1e3+"K"}}}}})}function createDistributionChart(){const t=document.getElementById("distributionPieChart");if(!t)return;const a=barangayData.slice(0,10),e=[COLORS.primary,COLORS.accent,COLORS.success,COLORS.info,"#8B5CF6","#EC4899","#14B8A6","#F59E0B","#6366F1",COLORS.secondary];charts.distribution=new Chart(t,{type:"doughnut",data:{labels:a.map(t=>t.name),datasets:[{data:a.map(t=>t.pop),backgroundColor:e,borderColor:"#fff",borderWidth:3,hoverBorderWidth:3,hoverOffset:8}]},options:{responsive:!0,maintainAspectRatio:!1,animation:{animateRotate:!0,animateScale:!0,duration:1500,easing:"easeOutQuart"},cutout:"55%",plugins:{legend:{position:"right",labels:{boxWidth:14,padding:12,font:{size:12},usePointStyle:!0,pointStyle:"circle"}},tooltip:{backgroundColor:"rgba(0, 50, 160, 0.95)",titleFont:{size:14,weight:"600"},bodyFont:{size:13},padding:12,cornerRadius:8,callbacks:{label:t=>{const a=t.dataset.data.reduce((t,a)=>t+a,0),e=(t.raw/a*100).toFixed(1);return`${t.raw.toLocaleString()} (${e}%)`}}}}}})}function createBarChart(){const t=document.getElementById("populationBarChart");if(!t)return;const a=[...barangayData].sort((t,a)=>a.pop-t.pop);charts.bar=new Chart(t,{type:"bar",data:{labels:a.map(t=>t.name),datasets:[{label:"Population",data:a.map(t=>t.pop),backgroundColor:a.map((t,a)=>`rgba(0, 50, 160, ${1-.03*a})`),borderRadius:4,borderSkipped:!1}]},options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,animation:{duration:1500,easing:"easeOutQuart",delay:t=>50*t.dataIndex},plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(0, 50, 160, 0.95)",titleFont:{size:14,weight:"600"},bodyFont:{size:13},padding:12,cornerRadius:8,displayColors:!1,callbacks:{label:t=>`Population: ${t.raw.toLocaleString()}`}}},scales:{x:{beginAtZero:!0,grid:{color:"rgba(0,0,0,0.05)"},ticks:{font:{size:11},callback:t=>t.toLocaleString()}},y:{grid:{display:!1},ticks:{font:{size:11}}}}}})}function initCharts(){const t=new IntersectionObserver(a=>{a.forEach(a=>{if(a.isIntersecting){const e=a.target.id;"historicalLineChart"!==e||charts.historical?"distributionPieChart"!==e||charts.distribution?"populationBarChart"!==e||charts.bar||createBarChart():createDistributionChart():createHistoricalChart(),t.unobserve(a.target)}})},{threshold:.1});document.querySelectorAll("canvas").forEach(a=>{t.observe(a)})}function initEconomyCounters(){const t=new IntersectionObserver(a=>{a.forEach(a=>{if(a.isIntersecting){const e=a.target.querySelector("[data-count]");if(e){animateCount(e,parseInt(e.dataset.count),1500)}t.unobserve(a.target)}})},{threshold:.3});document.querySelectorAll(".economy-card").forEach(a=>{t.observe(a)})}const cmciData={years:["2016","2017","2018","2019","2020","2021","2022","2023","2024"],pillars:{economicDynamism:{labels:["Local Economy Size","Economy Growth","Active Establishments","Safety Compliant","Employment"],data:[[.4353,.1829,.1004,.042,.0328,.0935,.0344,.0571,.0259],[.0847,.003,.0081,.0028,.3297,.0026,0,5e-4,.0318],[null,.1411,.8263,.3719,.5391,.5346,.5349,.5154,.4994],[null,.2991,.3683,.2471,.247,.2629,0,.248,.2235],[.3157,.1756,.1604,.1599,.1807,.1636,.1433,.1485,.3835]]},governmentEfficiency:{labels:["Cost of Living","Cost of Business","Financial Deepening","Productivity","Compliance"],data:[[2.6667,1.6216,1.3889,1.1508,.8621,.4063,1.6635,1.1905,1.1919],[2.2968,2.2431,2.1045,1.9988,2.1827,2.1901,1.8629,1.546,1.5599],[2.2418,1.5657,.2448,.7057,.8357,.7899,1.1689,1.1263,.8288],[.0062,.0339,.0083,.004,.1654,.2272,.1243,.1451,.3297],[3.0994,2.1474,0,2.45,2.5,2.381,1.8929,1.9565,1.96]]},infrastructure:{labels:["Road Network","Distance to Ports","Basic Utilities","Transportation","IT Capacity"],data:[[.0019,3e-4,0,.009,.0021,.0235,.0015,.0016,.0016],[2.3543,1.8319,0,1.6595,2.4576,2.4658,1.3088,1.562,1.5281],[3.3333,2.5,0,1.8498,2.475,2.4714,.0037,.6363,.356],[.4063,.2816,0,.0343,.0221,.0153,.023,.0636,.0959],[1.4638,.4,0,.1278,.3108,.2727,.0617,.1674,.0155]]},resiliency:{labels:["DRR Plan","Disaster Drill","Early Warning","DRRMP Budget","Risk Assessments"],data:[[null,2.5,0,2.4537,2.5,2.4474,1.9995,1.9583,1.9783],[null,2.5,0,2.25,2.5,1.2583,1.002,1.0016,1.0023],[null,2.5,0,2.5,2.5,1.2573,1.0062,1.0033,1.0397],[null,.0022,0,.2655,.1649,.0183,0,.0699,.002],[null,2.5,0,2.5,2.5,2.5,2,2,2]]},innovation:{labels:["ICT Plan","R&D Expenditures","E-BPLS Software","STEM Graduates","Innovation Facilities"],data:[[null,null,null,null,null,null,1.3334,2.0001,2.0001],[null,null,null,null,null,null,0,0,6e-4],[null,null,null,null,null,null,2,0,2],[null,null,null,null,null,null,.0039,.0052,.0181],[null,null,null,null,null,null,.0392,.1669,.0227]]}},keyIndicators:{labels:["Health","Education","Social Protection","Peace & Order","LGU Investment"],data:[[.7476,.5608,0,.3946,.3941,.469,.3219,.2037,.2995],[.0605,.0992,0,.0348,.1006,.0231,.1263,.0764,.1341],[.2988,.2421,0,.2778,.2845,.4097,.0011,.2567,.4923],[.0638,.408,0,.0395,.0347,.0649,0,.2571,.1031],[2.4381,.2859,0,.2648,.1597,.0191,0,.0016,.0108]]}};function createCMCIOverviewChart(){const t=document.getElementById("cmciOverviewChart");if(!t||charts.cmciOverview)return;const a=[COLORS.primary,COLORS.accent,COLORS.success,COLORS.info,"#8B5CF6"];charts.cmciOverview=new Chart(t,{type:"line",data:{labels:cmciData.years,datasets:cmciData.keyIndicators.labels.map((t,e)=>({label:t,data:cmciData.keyIndicators.data[e],borderColor:a[e],backgroundColor:a[e]+"20",fill:!1,tension:.4,pointRadius:4,pointHoverRadius:6,borderWidth:2}))},options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:1500,easing:"easeOutQuart"},interaction:{intersect:!1,mode:"index"},plugins:{legend:{position:"bottom",labels:{boxWidth:12,padding:16,font:{size:11},usePointStyle:!0}},tooltip:{backgroundColor:"rgba(0, 50, 160, 0.95)",padding:12,cornerRadius:8,callbacks:{label:t=>null!==t.raw?`${t.dataset.label}: ${t.raw.toFixed(4)}`:`${t.dataset.label}: N/A`}}},scales:{x:{grid:{display:!1},ticks:{font:{size:11}}},y:{beginAtZero:!0,grid:{color:"rgba(0,0,0,0.05)"},ticks:{font:{size:11}}}}}})}function createCMCIPillarChart(t,a){const e=document.getElementById(a);if(!e||charts[a])return;const n=cmciData.pillars[t];if(!n)return;const o=[COLORS.primary,COLORS.accent,COLORS.success,COLORS.info,"#8B5CF6"];charts[a]=new Chart(e,{type:"line",data:{labels:cmciData.years,datasets:n.labels.map((t,a)=>({label:t,data:n.data[a],borderColor:o[a],backgroundColor:o[a]+"20",fill:!1,tension:.4,pointRadius:3,pointHoverRadius:5,borderWidth:2}))},options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:1200,easing:"easeOutQuart"},interaction:{intersect:!1,mode:"index"},plugins:{legend:{position:"bottom",labels:{boxWidth:10,padding:12,font:{size:10},usePointStyle:!0}},tooltip:{backgroundColor:"rgba(0, 50, 160, 0.95)",padding:10,cornerRadius:6,callbacks:{label:t=>null!==t.raw?`${t.dataset.label}: ${t.raw.toFixed(4)}`:`${t.dataset.label}: N/A`}}},scales:{x:{grid:{display:!1},ticks:{font:{size:10}}},y:{beginAtZero:!0,grid:{color:"rgba(0,0,0,0.05)"},ticks:{font:{size:10}}}}}})}function initCMCITabs(){const t=document.querySelectorAll(".cmci-tab"),a=document.querySelectorAll(".cmci-panel");t.length&&t.forEach(e=>{e.addEventListener("click",()=>{const n=e.dataset.pillar;t.forEach(t=>t.classList.remove("active")),e.classList.add("active"),a.forEach(t=>t.classList.remove("active"));const o=document.getElementById(`panel-${n}`);o&&(o.classList.add("active"),"overview"===n?createCMCIOverviewChart():"economic-dynamism"===n?createCMCIPillarChart("economicDynamism","cmciEconomicChart"):"government-efficiency"===n?createCMCIPillarChart("governmentEfficiency","cmciGovernmentChart"):"infrastructure"===n?createCMCIPillarChart("infrastructure","cmciInfraChart"):"resiliency"===n?createCMCIPillarChart("resiliency","cmciResiliencyChart"):"innovation"===n&&createCMCIPillarChart("innovation","cmciInnovationChart"),animateCMCIBars(o))})})}function animateCMCIBars(t){t.querySelectorAll(".indicator-fill").forEach(t=>{const a=t.dataset.value;a&&setTimeout(()=>{t.style.setProperty("--fill-width",a+"%"),t.classList.add("animated")},100)})}function initCMCISection(){const t=document.getElementById("competitive-index");if(!t)return;const a=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(initCMCITabs(),createCMCIOverviewChart(),animateCMCIBars(document.getElementById("panel-overview")),a.unobserve(t.target))})},{threshold:.1});a.observe(t)}document.addEventListener("DOMContentLoaded",()=>{initScrollAnimations(),initCharts(),initEconomyCounters(),initCMCISection()}),"undefined"!=typeof module&&module.exports&&(module.exports={barangayData:barangayData,historicalData:historicalData,cmciData:cmciData,COLORS:COLORS,animateCount:animateCount});