const COLORS={primary:"#0032a0",secondary:"#003D82",success:"#06A77D",danger:"#D62828",info:"#0077BE",accent:"#F77F00"};let charts={};function initScrollAnimations(){const e=new IntersectionObserver(t=>{t.forEach(t=>{if(t.isIntersecting){const a=t.target.dataset.delay||0;setTimeout(()=>{t.target.classList.add("visible"),animateBars(t.target)},a),e.unobserve(t.target)}})},{threshold:.2});document.querySelectorAll(".animate-on-scroll, .metric-card").forEach(t=>{e.observe(t)})}function animateBars(e){e.querySelectorAll(".expenditure-fill").forEach(e=>{const t=e.dataset.width;t&&setTimeout(()=>{e.style.width=t+"%"},200)})}function createIncomeChart(){const e=document.getElementById("incomeChart");e&&(charts.income=new Chart(e,{type:"doughnut",data:{labels:["Local Sources","External Sources (IRA)"],datasets:[{data:[149.81,221.52],backgroundColor:[COLORS.success,COLORS.info],borderColor:"#fff",borderWidth:3,hoverOffset:8}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"60%",animation:{animateRotate:!0,animateScale:!0,duration:1500,easing:"easeOutQuart"},plugins:{legend:{position:"bottom",labels:{boxWidth:14,padding:16,font:{size:12},usePointStyle:!0,pointStyle:"circle"}},tooltip:{backgroundColor:"rgba(0, 50, 160, 0.95)",titleFont:{size:14,weight:"600"},bodyFont:{size:13},padding:12,cornerRadius:8,callbacks:{label:function(e){const t=e.dataset.data.reduce((e,t)=>e+t,0),a=(e.raw/t*100).toFixed(1);return`₱${e.raw}M (${a}%)`}}}}}}))}function createExpenditureChart(){const e=document.getElementById("expenditureChart");e&&(charts.expenditure=new Chart(e,{type:"doughnut",data:{labels:["General Public Services","Social Services","Economic Services","Debt Service"],datasets:[{data:[172.28,50.81,37.95,1.63],backgroundColor:[COLORS.primary,COLORS.success,COLORS.accent,COLORS.info],borderColor:"#fff",borderWidth:3,hoverOffset:8}]},options:{responsive:!0,maintainAspectRatio:!1,cutout:"60%",animation:{animateRotate:!0,animateScale:!0,duration:1500,easing:"easeOutQuart"},plugins:{legend:{position:"bottom",labels:{boxWidth:14,padding:12,font:{size:11},usePointStyle:!0,pointStyle:"circle"}},tooltip:{backgroundColor:"rgba(0, 50, 160, 0.95)",titleFont:{size:14,weight:"600"},bodyFont:{size:13},padding:12,cornerRadius:8,callbacks:{label:function(e){const t=e.dataset.data.reduce((e,t)=>e+t,0),a=(e.raw/t*100).toFixed(1);return`₱${e.raw}M (${a}%)`}}}}}}))}function initCharts(){const e=new IntersectionObserver(t=>{t.forEach(t=>{if(t.isIntersecting){const a=t.target.id;"incomeChart"!==a||charts.income?"expenditureChart"!==a||charts.expenditure||createExpenditureChart():createIncomeChart(),e.unobserve(t.target)}})},{threshold:.1});document.querySelectorAll("canvas").forEach(t=>{e.observe(t)})}document.addEventListener("DOMContentLoaded",()=>{initScrollAnimations(),initCharts()});